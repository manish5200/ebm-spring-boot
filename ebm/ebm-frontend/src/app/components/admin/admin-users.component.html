<div class="container mt-4">
  <h2 class="mb-4">All Customers</h2>
  <div *ngIf="loading" class="text-center py-5">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
    <p class="mt-3 text-muted">Loading users...</p>
  </div>
  <div *ngIf="error" class="alert alert-danger">{{ error }}</div>
  <div *ngIf="success" class="alert alert-success">{{ success }}</div>
  <table class="table table-hover table-bordered" *ngIf="!loading && users.length">
    <thead class="table-light">
      <tr>
        <th>#</th>
        <th>Username</th>
        <th>Email</th>
        <th>Full Name</th>
        <th>Phone</th>
        <th>Address</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let user of users; let i = index">
        <td>{{ i + 1 }}</td>
        <td>{{ user.username }}</td>
        <td>{{ user.email }}</td>
        <td>{{ user.firstName }} {{ user.lastName }}</td>
        <td>{{ user.phoneNumber }}</td>
        <td>{{ user.address }}</td>
        <td>
          <button class="btn btn-info btn-sm me-2" (click)="viewUser(user)">
            <i class="fas fa-eye"></i> View
          </button>
          <button class="btn btn-danger btn-sm" (click)="confirmDeleteUser = user">
            <i class="fas fa-trash"></i> Delete
          </button>
        </td>
      </tr>
    </tbody>
  </table>
  <div *ngIf="!loading && !users.length" class="alert alert-info">No users found.</div>

  <!-- User Details Modal -->
  <div class="modal fade" id="userModal" tabindex="-1" aria-hidden="true" *ngIf="selectedUser">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">User Details</h5>
          <button type="button" class="btn-close" (click)="selectedUser = null"></button>
        </div>
        <div class="modal-body">
          <p><strong>Username:</strong> {{ selectedUser.username }}</p>
          <p><strong>Email:</strong> {{ selectedUser.email }}</p>
          <p><strong>Name:</strong> {{ selectedUser.firstName }} {{ selectedUser.lastName }}</p>
          <p><strong>Phone:</strong> {{ selectedUser.phoneNumber }}</p>
          <p><strong>Address:</strong> {{ selectedUser.address }}</p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" (click)="selectedUser = null">Close</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Delete Confirmation Modal -->
  <div class="modal fade show" tabindex="-1" style="display: block; background: rgba(0,0,0,0.3);" *ngIf="confirmDeleteUser">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Confirm Delete</h5>
          <button type="button" class="btn-close" (click)="confirmDeleteUser = null"></button>
        </div>
        <div class="modal-body">
          <p>Are you sure you want to delete user <strong>{{ confirmDeleteUser.username }}</strong>?</p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-danger" (click)="deleteUser(confirmDeleteUser)">Delete</button>
          <button type="button" class="btn btn-secondary" (click)="confirmDeleteUser = null">Cancel</button>
        </div>
      </div>
    </div>
  </div>
</div>